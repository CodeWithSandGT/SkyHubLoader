local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/jensonhirst/Orion/main/source')))()
local Window = OrionLib:MakeWindow({
    Name = "SkyHub",
    HidePremium = false,
    SaveConfig = true,
    ConfigFolder = "SkyHubConfig",
    IntroText = "SkyHub"
})

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Variabel kontrol auto fish
local autoFishing = false
local autoLoopThread = nil

-- Fungsi klik layar
local function clickLayar()
    VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
    task.wait(0.05)
    VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
end

-- Fungsi minigame satu kali
local function startFishingOnce()
    local ui = playerGui:FindFirstChild("FishingMinigameUI")
    if not ui then return end

    local container = ui:WaitForChild("Container"):WaitForChild("BarFrame")
    local bar = container:WaitForChild("Bar")
    local center = container:WaitForChild("Center")

    local holding = false
    local connection

    connection = RunService.RenderStepped:Connect(function()
        if not bar.Visible or not ui.Enabled or not autoFishing then
            if holding then
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
                holding = false
            end
            connection:Disconnect()
            return
        end

        local barX = bar.AbsolutePosition.X + bar.AbsoluteSize.X / 2
        local centerX = center.AbsolutePosition.X + center.AbsoluteSize.X / 2

        if barX < centerX - 2 then
            if not holding then
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 1)
                holding = true
            end
        else
            if holding then
                VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 1)
                holding = false
            end
        end
    end)
end

-- Loop utama Auto Fishing
local function startLoop()
    autoLoopThread = task.spawn(function()
        while autoFishing do
            clickLayar()
            local found = false

            for i = 1, 100 do
                local ui = playerGui:FindFirstChild("FishingMinigameUI")
                if ui and ui.Enabled then
                    found = true
                    break
                end
                task.wait(0.1)
            end

            if found then
                startFishingOnce()
                while autoFishing and playerGui:FindFirstChild("FishingMinigameUI") and playerGui.FishingMinigameUI.Enabled do
                    task.wait(0.2)
                end
            else
                task.wait(1)
            end
        end
    end)
end

-- Stop Auto Fishing
local function stopLoop()
    autoFishing = false
    if autoLoopThread then
        task.cancel(autoLoopThread)
        autoLoopThread = nil
    end
end

-- Tab Main
local MainTab = Window:MakeTab({
    Name = "Main",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

-- Toggle untuk auto fish
MainTab:AddToggle({
    Name = "Auto Fish",
    Default = false,
    Callback = function(Value)
        autoFishing = Value
        if Value then
            OrionLib:MakeNotification({
                Name = "Auto Fish ON",
                Content = "Auto fishing dimulai!",
                Image = "rbxassetid://4483345998",
                Time = 5
            })
            startLoop()
        else
            OrionLib:MakeNotification({
                Name = "Auto Fish OFF",
                Content = "Auto fishing dihentikan.",
                Image = "rbxassetid://4483345998",
                Time = 5
            })
            stopLoop()
        end
    end
})

-- Tab Kredit
local CreditTab = Window:MakeTab({
    Name = "Credit",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

CreditTab:AddLabel("Join our Discord: https://dsc.gg/skyhubs")
CreditTab:AddLabel("Youtube: https://youtube.com/@skyhubcommunitys")

-- Notifikasi tiap 1 menit
task.spawn(function()
    while true do
        OrionLib:MakeNotification({
            Name = "Support Us!",
            Content = "Join Discord & Subscribe YouTube:\nCheck the Credit tab!",
            Image = "rbxassetid://4483345998",
            Time = 5
        })
        task.wait(60)
    end
end)
